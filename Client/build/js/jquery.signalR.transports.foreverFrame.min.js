!function(e,n,t){"use strict";var o=e.signalR,r=e.signalR.events,a=e.signalR.changeState,i=o.transports._logic,c=function(){var e=n.document.createElement("iframe");return e.setAttribute("style","position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;"),e},s=function(){var e=null,t=1e3,r=0;return{prevent:function(){o._.ieVersion<=8&&(0===r&&(e=n.setInterval(function(){var e=c();n.document.body.appendChild(e),n.document.body.removeChild(e),e=null},t)),r++)},cancel:function(){1===r&&n.clearInterval(e),r>0&&r--}}}();o.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:function(){return!0},iframeClearThreshold:50,start:function(e,t,o){var r,a=this,d=i.foreverFrame.count+=1,f=c(),m=function(){e.log("Forever frame iframe finished loading and is no longer receiving messages."),o&&o()||a.reconnect(e)};return n.EventSource?void(o&&(e.log("Forever Frame is not supported by SignalR on browsers with SSE support."),o())):(f.setAttribute("data-signalr-connection-id",e.id),s.prevent(),r=i.getUrl(e,this.name),r+="&frameId="+d,n.document.documentElement.appendChild(f),e.log("Binding to iframe's load event."),f.addEventListener?f.addEventListener("load",m,!1):f.attachEvent&&f.attachEvent("onload",m),f.src=r,i.foreverFrame.connections[d]=e,e.frame=f,e.frameId=d,void(t&&(e.onSuccess=function(){e.log("Iframe transport started."),t()})))},reconnect:function(e){var t=this;i.isConnectedOrReconnecting(e)&&i.verifyLastActive(e)&&n.setTimeout(function(){if(i.verifyLastActive(e)&&e.frame&&i.ensureReconnectingState(e)){var n=e.frame,o=i.getUrl(e,t.name,!0)+"&frameId="+e.frameId;e.log("Updating iframe src to '"+o+"'."),n.src=o}},e.reconnectDelay)},lostConnection:function(e){this.reconnect(e)},send:function(e,n){i.ajaxSend(e,n)},receive:function(n,t){var r,a,c;if(n.json!==n._originalJson&&(t=n._originalJson.stringify(t)),c=n._parseResponse(t),i.processMessages(n,c,n.onSuccess),n.state===e.signalR.connectionState.connected&&(n.frameMessageCount=(n.frameMessageCount||0)+1,n.frameMessageCount>o.transports.foreverFrame.iframeClearThreshold&&(n.frameMessageCount=0,r=n.frame.contentWindow||n.frame.contentDocument,r&&r.document&&r.document.body)))for(a=r.document.body;a.firstChild;)a.removeChild(a.firstChild)},stop:function(e){var t=null;if(s.cancel(),e.frame){if(e.frame.stop)e.frame.stop();else try{t=e.frame.contentWindow||e.frame.contentDocument,t.document&&t.document.execCommand&&t.document.execCommand("Stop")}catch(n){e.log("Error occurred when stopping foreverFrame transport. Message = "+n.message+".")}e.frame.parentNode===n.document.body&&n.document.body.removeChild(e.frame),delete i.foreverFrame.connections[e.frameId],e.frame=null,e.frameId=null,delete e.frame,delete e.frameId,delete e.onSuccess,delete e.frameMessageCount,e.log("Stopping forever frame.")}},abort:function(e,n){i.ajaxAbort(e,n)},getConnection:function(e){return i.foreverFrame.connections[e]},started:function(n){a(n,o.connectionState.reconnecting,o.connectionState.connected)===!0&&e(n).triggerHandler(r.onReconnect)}}}(window.jQuery,window);