!function(e,n,t){"use strict";function o(e){return e+l}function i(e,n,t){var o,i=e.length,r=[];for(o=0;o<i;o+=1)e.hasOwnProperty(o)&&(r[o]=n.call(t,e[o],o,e));return r}function r(n){return e.isFunction(n)?null:"undefined"===e.type(n)?null:n}function a(e){for(var n in e)if(e.hasOwnProperty(n))return!0;return!1}function s(e,n){var t,o=e._.invocationCallbacks;a(o)&&e.log("Clearing hub invocation callbacks with error: "+n+"."),e._.invocationCallbackId=0,delete e._.invocationCallbacks,e._.invocationCallbacks={};for(var i in o)t=o[i],t.method.call(t.scope,{E:n})}function c(e,n){return new c.fn.init(e,n)}function u(n,t){var o={qs:null,logging:!1,useDefaultPath:!0};return e.extend(o,t),n&&!o.useDefaultPath||(n=(n||"")+"/signalr"),new u.fn.init(n,o)}var l=".hubProxy",b=e.signalR;c.fn=c.prototype={init:function(e,n){this.state={},this.connection=e,this.hubName=n,this._={callbackMap:{}}},constructor:c,hasSubscriptions:function(){return a(this._.callbackMap)},on:function(n,t){var i=this,r=i._.callbackMap;return n=n.toLowerCase(),r[n]||(r[n]={}),r[n][t]=function(e,n){t.apply(i,n)},e(i).bind(o(n),r[n][t]),i},off:function(n,t){var i,r=this,s=r._.callbackMap;return n=n.toLowerCase(),i=s[n],i&&(i[t]?(e(r).unbind(o(n),i[t]),delete i[t],a(i)||delete s[n]):t||(e(r).unbind(o(n)),delete s[n])),r},invoke:function(n){var t=this,o=t.connection,a=e.makeArray(arguments).slice(1),s=i(a,r),c={H:t.hubName,M:n,A:s,I:o._.invocationCallbackId},u=e.Deferred(),l=function(i){var r,a,s=t._maximizeHubResponse(i);e.extend(t.state,s.State),s.Progress?u.notifyWith?u.notifyWith(t,[s.Progress.Data]):o._.progressjQueryVersionLogged||(o.log("A hub method invocation progress update was received but the version of jQuery in use ("+e.prototype.jquery+") does not support progress updates. Upgrade to jQuery 1.7+ to receive progress notifications."),o._.progressjQueryVersionLogged=!0):s.Error?(s.StackTrace&&o.log(s.Error+"\n"+s.StackTrace+"."),r=s.IsHubException?"HubException":"Exception",a=b._.error(s.Error,r),a.data=s.ErrorData,o.log(t.hubName+"."+n+" failed to execute. Error: "+a.message),u.rejectWith(t,[a])):(o.log("Invoked "+t.hubName+"."+n),u.resolveWith(t,[s.Result]))};return o._.invocationCallbacks[o._.invocationCallbackId.toString()]={scope:t,method:l},o._.invocationCallbackId+=1,e.isEmptyObject(t.state)||(c.S=t.state),o.log("Invoking "+t.hubName+"."+n),o.send(c),u.promise()},_maximizeHubResponse:function(e){return{State:e.S,Result:e.R,Progress:e.P?{Id:e.P.I,Data:e.P.D}:null,Id:e.I,IsHubException:e.H,Error:e.E,StackTrace:e.T,ErrorData:e.D}}},c.fn.init.prototype=c.fn,u.fn=u.prototype=e.connection(),u.fn.init=function(n,t){var i={qs:null,logging:!1,useDefaultPath:!0},r=this;e.extend(i,t),e.signalR.fn.init.call(r,n,i.qs,i.logging),r.proxies={},r._.invocationCallbackId=0,r._.invocationCallbacks={},r.received(function(n){var t,i,a,s,c,u;n&&("undefined"!=typeof n.P?(a=n.P.I.toString(),s=r._.invocationCallbacks[a],s&&s.method.call(s.scope,n)):"undefined"!=typeof n.I?(a=n.I.toString(),s=r._.invocationCallbacks[a],s&&(r._.invocationCallbacks[a]=null,delete r._.invocationCallbacks[a],s.method.call(s.scope,n))):(t=this._maximizeClientHubInvocation(n),r.log("Triggering client hub event '"+t.Method+"' on hub '"+t.Hub+"'."),c=t.Hub.toLowerCase(),u=t.Method.toLowerCase(),i=this.proxies[c],e.extend(i.state,t.State),e(i).triggerHandler(o(u),[t.Args])))}),r.error(function(e,n){var t,o;n&&(t=n.I,o=r._.invocationCallbacks[t],o&&(r._.invocationCallbacks[t]=null,delete r._.invocationCallbacks[t],o.method.call(o.scope,{E:e})))}),r.reconnecting(function(){r.transport&&"webSockets"===r.transport.name&&s(r,"Connection started reconnecting before invocation result was received.")}),r.disconnected(function(){s(r,"Connection was disconnected before invocation result was received.")})},u.fn._maximizeClientHubInvocation=function(e){return{Hub:e.H,Method:e.M,Args:e.A,State:e.S}},u.fn._registerSubscribedHubs=function(){var n=this;n._subscribedToHubs||(n._subscribedToHubs=!0,n.starting(function(){var t=[];e.each(n.proxies,function(e){this.hasSubscriptions()&&(t.push({name:e}),n.log("Client subscribed to hub '"+e+"'."))}),0===t.length&&n.log("No hubs have been subscribed to.  The client will not receive data from hubs.  To fix, declare at least one client side function prior to connection start for each hub you wish to subscribe to."),n.data=n.json.stringify(t)}))},u.fn.createHubProxy=function(e){e=e.toLowerCase();var n=this.proxies[e];return n||(n=c(this,e),this.proxies[e]=n),this._registerSubscribedHubs(),n},u.fn.init.prototype=u.fn,e.hubConnection=u}(window.jQuery,window);